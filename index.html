<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑูุฒ ุงูุฐูุงุก ุงูุงุตุทูุงุนู</title>
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a73e8">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <!-- ุดุฑูุท ุงูุชูุจููุงุช -->
        <div class="alert-bar" id="alertBar">
            <span id="alertText">ุฌุงุฑู ุงูุชุญููู...</span>
            <button class="close-alert" id="closeAlert">โ</button>
        </div>

        <!-- ุฒุฑ ุชุซุจูุช -->
        <button class="install-btn" id="installBtn">
            <i class="fas fa-download"></i> ุชุซุจูุช ุงูุชุทุจูู
        </button>

        <!-- ุงูุดุฑูุท ุงูุนููู -->
        <header class="top-bar">
            <button class="menu-btn" id="menuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h1>ูุฑูุฒ ุงูุฐูุงุก ุงูุงุตุทูุงุนู</h1>
            </div>
            
            <div class="header-actions">
                <button class="icon-btn" id="newChatBtn" title="ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="icon-btn" id="themeBtn" title="ุชุจุฏูู ุงูุณูุฉ">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-robot"></i> ุงูููุงุฐุฌ</h3>
                <button class="close-sidebar" id="closeSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="model-list" id="modelList">
                <!-- Models will be added by JS -->
            </div>
            
            <div class="specialization-section">
                <h4><i class="fas fa-magic"></i> ุงูุชุฎุตุตุงุช</h4>
                <div class="specialty-buttons">
                    <button class="specialty-btn" data-action="writer">
                        <i class="fas fa-pen"></i> ูุงุชุจ
                    </button>
                    <button class="specialty-btn" data-action="coder">
                        <i class="fas fa-code"></i> ูุจุฑูุฌ
                    </button>
                    <button class="specialty-btn" data-action="assistant">
                        <i class="fas fa-assistive-listening-systems"></i> ูุณุงุนุฏ
                    </button>
                    <button class="specialty-btn" data-action="researcher">
                        <i class="fas fa-search"></i> ุจุงุญุซ
                    </button>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="storage-info">
                    <div class="storage-bar">
                        <div class="storage-fill" id="storageFill"></div>
                    </div>
                    <span id="storageText">0 / 5 MB ูุณุชุฎุฏู</span>
                </div>
                
                <div class="user-section">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div>
                            <p class="user-name">ุฒุงุฆุฑ</p>
                            <div class="connection-status">
                                <span class="status-indicator" id="connectionStatusDot"></span>
                                <span id="connectionStatusText">ุฌุงุฑู ุงูุชุญูู...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <main class="main-content">
            <div class="welcome-section" id="welcomeSection">
                <div class="welcome-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h2>ูุฑุญุจูุง ุจู</h2>
                <p class="welcome-text" id="welcomeText">ุงุฎุชุฑ ูููุฐุฌูุง ูุชุจุฏุฃ ุงููุญุงุฏุซุฉ</p>
                
                <div class="quick-actions">
                    <div class="quick-action-card" data-action="question">
                        <i class="fas fa-question-circle"></i>
                        <h4>ุณุคุงู</h4>
                        <p>ุงุณุฃู ุนู ุฃู ููุถูุน</p>
                    </div>
                    <div class="quick-action-card" data-action="code">
                        <i class="fas fa-code"></i>
                        <h4>ููุฏ</h4>
                        <p>ุงูุชุจ ุฃู ุตุญุญ ุฃููุงุฏ</p>
                    </div>
                    <div class="quick-action-card" data-action="translate">
                        <i class="fas fa-language"></i>
                        <h4>ุชุฑุฌูุฉ</h4>
                        <p>ุชุฑุฌู ุจูู ุงููุบุงุช</p>
                    </div>
                    <div class="quick-action-card" data-action="creative">
                        <i class="fas fa-paint-brush"></i>
                        <h4>ุฅุจุฏุงุน</h4>
                        <p>ุฃูุดุฆ ูุญุชูู ุฅุจุฏุงุนู</p>
                    </div>
                </div>
            </div>

            <!-- ููุทูุฉ ุงููุญุงุฏุซุฉ -->
            <div class="chat-container" id="chatContainer" style="display:none;">
                <div class="chat-header">
                    <div class="current-model-info">
                        <span class="model-badge" id="currentModelBadge">
                            <i class="fas fa-bolt"></i> Phi-3
                        </span>
                        <span class="model-status-indicator">
                            <span class="status-dot active"></span>
                            <span id="modelStatusText">ุฌุงูุฒ</span>
                        </span>
                    </div>
                    <div class="chat-actions">
                        <button class="chat-action-btn" id="clearChatBtn">
                            <i class="fas fa-trash"></i> ูุณุญ ุงููุญุงุฏุซุฉ
                        </button>
                        <button class="chat-action-btn" id="openSettingsBtn">
                            <i class="fas fa-cog"></i> ุงูุฅุนุฏุงุฏุงุช
                        </button>
                    </div>
                </div>
                
                <div class="messages-container" id="messagesContainer">
                    <!-- Messages appear here -->
                </div>
            </div>
        </main>

        <!-- ุดุฑูุท ุงูุฅุฏุฎุงู -->
        <div class="input-container">
            <div class="input-wrapper">
                <div class="input-left-buttons">
                    <button class="input-btn" id="attachFileBtn" title="ุฑูุน ููู">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <button class="input-btn" id="thinkingBtn" title="ูุถุน ุงูุชูููุฑ">
                        <i class="fas fa-brain"></i>
                    </button>
                </div>
                
                <div class="input-main">
                    <textarea 
                        id="messageInput" 
                        placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง..."
                        rows="1"
                    ></textarea>
                </div>
                
                <div class="input-right-buttons">
                    <button class="input-btn" id="webSearchBtn" title="ุจุญุซ ุนูู ุงูููุจ">
                        <i class="fas fa-globe"></i>
                    </button>
                    <button class="send-btn" id="sendButton" title="ุฅุฑุณุงู">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            <div class="input-hint">
                <span>ุงูุชุทุจูู ูุนูู <strong>ุจุฏูู ุฅูุชุฑูุช</strong></span>
            </div>
        </div>

        <!-- ูุงูุฐุฉ ุชุนูููุงุช ุงูุชุซุจูุช -->
        <div class="modal" id="installModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-download"></i> ููููุฉ ุงูุชุซุจูุช</h3>
                    <button class="close-modal" id="closeInstallModal">โ</button>
                </div>
                <div class="modal-body">
                    <div class="install-steps">
                        <div class="install-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>ูู ูุชุตูุญ Chrome:</h4>
                                <p>ุงุถุบุท ุนูู <strong>โฎ</strong> โ "ุชุซุจูุช ุงูุชุทุจูู"</p>
                            </div>
                        </div>
                        <div class="install-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>ูู ูุชุตูุญ Safari:</h4>
                                <p>ุงุถุบุท ุนูู <strong>โ</strong> โ "ุฃุถู ุฅูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ"</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/app-simple.js"></script>
    
    <!-- PWA Script -->
    <script>
        // ุชุณุฌูู Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('โ Service Worker ูุณุฌู:', registration.scope);
                    })
                    .catch(error => {
                        console.error('โ ุฎุทุฃ ูู Service Worker:', error);
                    });
            });
        }
        
        // ุฅุฏุงุฑุฉ ุชุซุจูุช PWA
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('๐ฑ beforeinstallprompt event fired');
            e.preventDefault();
            deferredPrompt = e;
            
            // ุชุฃุฎูุฑ ุนุฑุถ ุงูุฒุฑ ููุฏุฉ 3 ุซูุงู
            setTimeout(() => {
                if (installBtn) {
                    installBtn.style.display = 'flex';
                    console.log('๐ ุนุฑุถ ุฒุฑ ุงูุชุซุจูุช');
                }
            }, 3000);
        });
        
        // ุฒุฑ ุงูุชุซุจูุช
        if (installBtn) {
            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) {
                    alert('ุฒุฑ ุงูุชุซุจูุช ุบูุฑ ูุชุงุญ. ุญุงูู ุชุญุฏูุซ ุงูุตูุญุฉ ุฃู ุงุณุชุฎุฏู ุงููุงุฆูุฉ ูู ุงููุชุตูุญ.');
                    return;
                }
                
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('โ ุชู ูุจูู ุงูุชุซุจูุช');
                    installBtn.style.display = 'none';
                } else {
                    console.log('โ ุชู ุฑูุถ ุงูุชุซุจูุช');
                }
                
                deferredPrompt = null;
            });
        }
        
        // ุนูุฏ ุงูุชุซุจูุช
        window.addEventListener('appinstalled', () => {
            console.log('๐ ุชู ุชุซุจูุช PWA');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
            deferredPrompt = null;
        });
        
        // ุญุงูุฉ ุงูุงุชุตุงู
        function updateConnectionStatus() {
            const isOnline = navigator.onLine;
            const statusDot = document.getElementById('connectionStatusDot');
            const statusText = document.getElementById('connectionStatusText');
            
            if (statusDot && statusText) {
                if (isOnline) {
                    statusDot.className = 'status-indicator online';
                    statusText.textContent = '๐ข ูุชุตู';
                } else {
                    statusDot.className = 'status-indicator offline';
                    statusText.textContent = '๐ด ุบูุฑ ูุชุตู';
                }
            }
        }
        
        window.addEventListener('online', updateConnectionStatus);
        window.addEventListener('offline', updateConnectionStatus);
        updateConnectionStatus(); // ุงูุชุดุบูู ุงูุฃููู
    </script>
</body>
</html>